{% extends "adminapp/index.html" %}
{% block content %}
<br>
<br>

<div class="container mt-5">
  <h3 class="mb-4">List of Tutors</h3>

  <form method="get" class="row g-3 mb-4">
    <div class="col-md-6">
      <select name="department" class="form-select" onchange="this.form.submit()">
        <option value="">-- Filter by Department --</option>
        {% for dept in departments %}
          <option value="{{ dept.id }}" {% if dept.id|stringformat:"s" == selected_dept %}selected{% endif %}>
            {{ dept.name }}
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2">
      <a href="{% url 'list_tutors' %}" class="btn btn-secondary">Reset</a>
    </div>
  </form>

  <table class="table table-bordered table-striped">
    <thead class="table-dark">
      <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Email</th>
        <th>Gender</th>
        <th>Phone</th>
        <th>Tutor ID</th>
        <th>Department</th>
        <th>HOD</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for tutor in page_obj %}

      <tr>
        <td>
          {% if tutor.image %}
            <img src="{{ tutor.image.url }}" width="50" height="50" class="rounded-circle">
          {% else %}
            <span class="text-muted">No Image</span>
          {% endif %}
        </td>
        <td>{{ tutor.name }}</td>
        <td>{{ tutor.email }}</td>
        <td>{{ tutor.gender }}</td>
        <td>{{ tutor.phone_number }}</td>
        <td>{{ tutor.tutor_id }}</td>
        <td>{{ tutor.department.name }}</td>
        <td>{{ tutor.hod.name }}</td>
        <td>
          <a href="{% url 'delete_tutor' tutor.id %}" class="btn btn-sm btn-danger"
             onclick="return confirm('Are you sure you want to delete this tutor?');">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="9" class="text-center">No Tutors Found</td></tr>
      {% endfor %}
    </tbody>
  </table>
  <nav aria-label="Tutor pagination" class="mt-4">
  <ul class="pagination justify-content-center">
    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?{% if selected_dept %}department={{ selected_dept }}&{% endif %}page={{ page_obj.previous_page_number }}">Previous</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
      {% else %}
        <li class="page-item">
          <a class="page-link" href="?{% if selected_dept %}department={{ selected_dept }}&{% endif %}page={{ num }}">{{ num }}</a>
        </li>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?{% if selected_dept %}department={{ selected_dept }}&{% endif %}page={{ page_obj.next_page_number }}">Next</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>

</div>
{% endblock %}
